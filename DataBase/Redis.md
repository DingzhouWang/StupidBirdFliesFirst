<!--
 * @Author: your name
 * @Date: 2020-05-25 13:25:42
 * @LastEditTime: 2020-05-25 13:42:08
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \undefinedc:\Users\conan\Desktop\LongTime\StupidBirdFliesFirst\DataBase\Redis.md
--> 
# Redis
## 概述 
&emsp;&emsp;Redis就是非关系型数据库的一种，是一种基于内存的数据库，并且提供一定的持久化功能。在日常对数据库的访问中，读操作的次数远超写操作，比例大概在 1:9 到 3:7，所以需要读的可能性是比写的可能大得多的。当我们使用SQL语句去数据库进行读写操作时，数据库就会去磁盘把对应的数据索引取回来，这是一个相对较慢的过程。如果我们把数据放在 Redis 中，也就是直接放在内存之中，让服务端直接去读取内存中的数据，那么这样速度明显就会快上不少，并且会极大减小数据库的压力。Redis可以支持每秒十几万此的读/写操作，其性能远超关系型数据库，并且还支持集群、分布式、主从同步等配置，原则上可以无限扩展，让更多的数据存储在内存中，还支持一定的事务能力，这保证了高并发的场景下数据的安全和一致性。

## 使用原则
&emsp;&emsp;由于使用内存进行数据存储开销也是比较大的，限于成本的原因，一般我们**只是使用 Redis 存储一些常用和主要的数据**，比如用户登录的信息等。

&emsp;&emsp;一般而言在使用 Redis 进行存储的时候，我们需要从以下几个方面来考虑：
- 业务数据常用吗？命中率如何？如果命中率很低，就没有必要写入缓存；
- 该业务数据是读操作多，还是写操作多？如果写操作多，频繁需要写入数据库，也没有必要使用缓存；
- 业务数据大小如何？如果要存储几百兆字节的文件，会给缓存带来很大的压力，这样也没有必要；

## Redis的读写流程
### 读取
1. 当第一次读取数据的时候，读取Redis的数据就会失败，此时就会触发程序读取数据库，把数据读取出来，并且写入Redis中（也就是说这一次的作用仅仅就是把数据从数据库里载入缓存）；
2. 当第二次以及以后需要读取数据时，就会直接读取 Redis，读到数据后就结束了流程，这样速度就大大提高了。

### 写入
1. 先写入数据库
2. 再在更新中写入Redis

### 高速读写
用于应对高并发状况，比如天猫双11、抢红包、抢演唱会门票等：
1. 当一个请求到达服务器时，只是把业务数据在 Redis 上进行读写，而没有对数据库进行任何的操作，这样就能大大提高读写的速度，从而满足高速响应的需求；
2. 但是这些缓存的数据仍然需要持久化，也就是存入数据库之中，所以在一个请求操作完Redis的读/写之后，会去判断该高速读/写的业务是否结束，这个判断通常会在秒杀商品为0，红包金额为0时成立，如果不成立，则不会操作数据库；如果成立，则触发事件将Redis的缓存的数据以批量的形式一次性写入数据库，从而完成持久化的工作。