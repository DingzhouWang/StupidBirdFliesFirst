<!--
 * @Author: your name
 * @Date: 2020-06-13 22:09:25
 * @LastEditTime: 2020-06-13 22:50:59
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \undefinedc:\Users\conan\Desktop\LongTime\StupidBirdFliesFirst\DataBase\index.md
--> 
# 索引
## B树
B树是数据库存储索引所使用的数据机构，是使用检索能够快速检索的关键。B树来源于平衡二叉树，所以现在先简单介绍一下平衡二叉树

### 平衡二叉树
平衡二叉树基于二分法，将数据按照各自的大小比较存进树中，主要有以下特点：
- 非叶子节点最多拥有两个子节点；
- 非叶子节值大于左边子节点、小于右边子节点；
- 树的左右两边的层级数相差不会大于1;
- 没有值相等重复的节点;

### B树
B树与平衡二叉树相比不用一定是每个节点最多两个子节点，它可以有更多的子节点，且每个节点可以包含多个元素：
- 每个节点有m个子节点，成为你m阶（m=2时就是二叉树）
- 每个节点包含的元素数量大于等于ceil(m/2)-1个（ceil表示向上取整）且小于m-1个
- 根节点最少可以有一个元素
- 所有叶子结点都位于同一层，或者说根结点到每个叶子结点的长度都相同
- 每个结点中的关键字都按照从小到大的顺序排列，每个关键字的左子树中的所有关键字都小于它，而右子树中的所有关键字都大于它。

其中这种B树的存储方式是每个节点都会存储索引及指向的数据，如图所示：
![](btree.png)
上图就是一个阶数为4的B树。可以看出每个节点存的是一组值，表示一个key对应一个value，其中key就表示数据库中的索引，value就表示指向这一行的指针（或者说是逻辑地址）。

这种查找结构从查找次数来说跟二叉树其实是差不多的，但是在把磁盘里的数据加载到内存中的时候，是以页为单位来加载的，而我们也知道，节点与节点之间的数据是不连续的，所以不同的节点，很有可能分布在不同的磁盘页中。所以对于二叉查找树，比较多少次就是要做几次寻址加载，这对于计算机来说负担是比较重的。

但是在B树种，由于每个节点可以放多个元素，所以磁盘做寻址加载的次数就更少，在计算机种，每一次做数值的比较是在内存中做的，这至少比磁盘的寻址加载速度快了几百倍，所以宁可多比较几回，也要减少寻址加载的次数。

实际上磁盘的加载次数，基本上是和树的高度相关联的，高度越高，加载次数越多，越矮，加载次数越少。所以对于这种文件索引的存储，我们一般会选择矮胖的树形结构。